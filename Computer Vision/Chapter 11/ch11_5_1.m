figure(1);
A1 = imread("Fig1125(a)(WashingtonDC_Band1_512).tif");
A2 = imread("Fig1125(b)(WashingtonDC_Band2_512).tif");
A3 = imread("Fig1125(c)(WashingtonDC_Band3_512).tif");
A4 = imread("Fig1125(d)(WashingtonDC_Band4_512).tif");
A5 = imread("Fig1125(e)(WashingtonDC_Band5_512).tif");
A6 = imread("Fig1125(f)(WashingtonDC_Band6_512).tif");

subplot(2,3,1), imshow(A1), title('Видимый синий свет');
subplot(2,3,2), imshow(A2), title('Видимый зеленый свет');
subplot(2,3,3), imshow(A3), title('Видимый красный свет');
subplot(2,3,4), imshow(A4), title('Близкое инфр. излучение');
subplot(2,3,5), imshow(A5), title('Среднее инфр. излучение');
subplot(2,3,6), imshow(A6), title('Тепловое инфр. излучение');

figure(2);
S = cat(3, A1, A2, A3, A4, A5, A6);
[X, R] = imstack2vectors(S);
P = princomp(X, 6);
g1 = P.Y(:, 1);
g1 = reshape(g1, 512, 512);
g2 = P.Y(:, 2);
g2 = reshape(g2, 512, 512);
g3 = P.Y(:, 3);
g3 = reshape(g3, 512, 512);
g4 = P.Y(:, 4);
g4 = reshape(g4, 512, 512);
g5 = P.Y(:, 5);
g5 = reshape(g5, 512, 512);
g6 = P.Y(:, 6);
g6 = reshape(g6, 512, 512);
subplot(2,3,1), imshow(g1, []), title('Гл. комп. видимого синего света');
subplot(2,3,2), imshow(g2, []), title('Гл. комп. видимого зеленого света');
subplot(2,3,3), imshow(g3, []), title('Гл. комп. красного синего света');
subplot(2,3,4), imshow(g4, []), title('Гл. комп. близкого инфр. излучения');
subplot(2,3,5), imshow(g5, []), title('Гл. комп. среднего инфр. излучения');
subplot(2,3,6), imshow(g6, []), title('Гл. комп. теплового инфр. излучения');

figure(3);
d = diag(P.Cy);
P = princomp(X, 2);
h1 = P.X(:, 1);
h1 = reshape(h1, 512, 512);
h2 = P.X(:, 2);
h2 = reshape(h2, 512, 512);
h3 = P.X(:, 3);
h3 = reshape(h3, 512, 512);
h4 = P.X(:, 4);
h4 = reshape(h4, 512, 512);
h5 = P.X(:, 5);
h5 = reshape(h5, 512, 512);
h6 = P.X(:, 6);
h6 = reshape(h6, 512, 512);
subplot(2,3,1), imshow(h1, []);
subplot(2,3,2), imshow(h2, []);
subplot(2,3,3), imshow(h3, []);
subplot(2,3,4), imshow(h4, []);
subplot(2,3,5), imshow(h5, []);
subplot(2,3,6), imshow(h6, []);

figure(4);
D1 = double(A1) - double(h1);
D1 = gscale(D1);
D2 = double(A2) - double(h2);
D2 = gscale(D2);
D3 = double(A3) - double(h3);
D3 = gscale(D3);
D4 = double(A4) - double(h4);
D4 = gscale(D4);
D5 = double(A5) - double(h5);
D5 = gscale(D5);
D6 = double(A6) - double(h6);
D6 = gscale(D6);

subplot(2,3,1), imshow(D1, []);
subplot(2,3,2), imshow(D2, []);
subplot(2,3,3), imshow(D3, []);
subplot(2,3,4), imshow(D4, []);
subplot(2,3,5), imshow(D5, []);
subplot(2,3,6), imshow(D6, []);

